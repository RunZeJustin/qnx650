
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-us" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
      <meta name="copyright" content="(C) Copyright 2005" />
      <meta name="DC.rights.owner" content="(C) Copyright 2005" />
      <meta name="DC.Type" content="concept" />
      <meta name="DC.Title" content="Building with profiling enabled" />
      <meta name="abstract" content="" />
      <meta name="description" content="" />
      <meta name="DC.Relation" scheme="URI" content="../topic/profiler_build_.html" />
      <meta name="DC.Format" content="XHTML" />
      <meta name="DC.Identifier" content="BuildWithProfilingEnabled" />
      <meta name="DC.Language" content="en-us" />
      <link rel="stylesheet" type="text/css" href="../commonltr.css" />
      <link rel="stylesheet" type="text/css" href="../style.css" />
      <title>Building with profiling enabled</title>
   </head>
   <body id="BuildWithProfilingEnabled"><a name="BuildWithProfilingEnabled" shape="rect">
         <!-- --></a>
      
      
      
      <h1 class="topictitle1">Building with profiling enabled</h1>
      
      
      
      <div>
         <p></p>
         
         
         <p>For an existing project, when you build your project to profile an application to capture performance information, profiling
            can provide you with decision-making capabilities to help discover functions that consume the most CPU time. However, to instrument
            your code, you'll need to change the existing configuration options so that you can build your project with profiling enabled.
            The IDE will then insert code before each function to gather call information (Call Count instrumentation) or just after the
            function enters, and just before the function exits (Function Instrumentation). 
         </p>
         
         
         <p>To configure profiling for the selected project, depending on your type of project, do one of the following:</p>
         
         <br clear="none" /><ul>
            <li>For a QNX C/C++ project: <br clear="none" /><ol>
                  <li>In the Project Explorer view, right-click your project and select <span class="uicontrol">Properties</span>. 
                  </li>
                  <li>In the left pane, select <span class="uicontrol">QNX C/C++ project</span>. 
                  </li>
                  <li>In the right pane, select the <span class="uicontrol">Options</span> tab. 
                  </li>
                  <li>Do one of the following: <br clear="none" /><ul>
                        <li>Select <span class="uicontrol">Build for Profiling (Function Instrumentation)</span> to enable Function Instrumentation mode. 
                        </li>
                        <li>Select <span class="uicontrol">Build for Profiling (Call Count Instrumentation)</span> to enable Call Count mode. 
                           <p>
                              <span><img src="../images/uild_With_Profiling_Enabled.xml_d145016e59.jpg" alt="Properties for a project: Options tab" /></span>
                              
                           </p>
                           
                        </li>
                     </ul>
                     
                  </li>
                  <li>Click <span class="uicontrol">OK</span>. 
                  </li>
                  <li>When prompted, click <span class="uicontrol">Yes</span> to rebuild your project. 
                  </li>
               </ol>
               
            </li>
            <li>For a managed project: <br clear="none" /><ol>
                  <li>Right-click on a project and select <span class="uicontrol">Properties</span>. 
                  </li>
                  <li>From the menu, select <span class="menucascade">
                        <span class="uicontrol">C/C++ Build</span>
                        &gt; <span class="uicontrol">Settings</span>
                        &gt; <span class="uicontrol">Tools settings</span>
                        </span>. 
                  </li>
                  <li>Switch to the <span class="uicontrol">Profile</span> configuration using the <span class="uicontrol">Manage Configurations</span> button, or create a new configuration if one doesn't currently exist. 
                  </li>
                  <li>From the list on the right, for your compiler from the list, i.e. <span class="uicontrol">QCC Compiler</span>, select an item from the list and select <span class="uicontrol">Output Control</span>. 
                     <p>
                        <span><img src="../images/uild_With_Profiling_Enabled.xml_d145016e125.jpg" alt="Tools Setting Properties for a managed project" /></span>
                        
                     </p>
                     
                  </li>
                  <li>Do one of the following: <br clear="none" /><ul>
                        <li>To enable Function Instrumentation mode, select the <span class="uicontrol">Build for Profiling (Function Instrumentation)</span> option. 
                        </li>
                        <li>To enable Call Count Instrumentation mode, select the <span class="uicontrol">Enable call count profiling (<span class="option">-p</span>)</span> option. 
                        </li>
                     </ul>
                     
                  </li>
                  <li>From the list on the right, for your linker in the list (i.e. <span class="uicontrol">QCC Linker</span>), select an item from the list, then select <span class="uicontrol">Output Control</span>. 
                  </li>
                  <li>Do one of the following: <br clear="none" /><ul>
                        <li>To enable Function Instrumentation mode, select the <span class="uicontrol">Build for Profiling (Function Instrumentation) (<span class="option">-lprofilingS</span>)</span> option. 
                        </li>
                        <li>To enable Call Count Instrumentation mode, select the <span class="uicontrol">Build for Profiling (Call Count) (<span class="option">-p</span>)</span> option. 
                        </li>
                     </ul>
                     
                  </li>
                  <li>Click <span class="uicontrol">OK</span>. 
                  </li>
                  <li>Run a project <span class="uicontrol">Clean</span> for your project, and then build the project. 
                  </li>
               </ol>
               
            </li>
            <li>For a <span class="filepath">Makefile</span>: <br clear="none" /><ul>
                  <li>For Function Instrumentation: <br clear="none" /><ol>
                        <li>To compile the application or library with Function Instrumentation, add the option <span class="option">-finstrument-functions</span>. 
                        </li>
                        <li>For linking, add the argument <span class="option">-lprofilingS</span>. 
                        </li>
                     </ol>
                     
                  </li>
                  <li>For Call Count instrumentation, use the <span class="option">-p</span> option for compiling and linking. 
                     <div class="note"><span class="notetitle">Note:</span> 
                        
                        <p>For example, your <span class="filepath">Makefile</span> might have a line like this: 
                        </p>
                        
                        <pre class="codeblock" xml:space="preserve">CFLAGS=-p CXXFLAGS=-p LDFLAGS=-p</pre>
                        
                        <p>For a standard <span class="filepath">Makefile</span> that uses default rules, your file would have the <span class="option">-finstrument-functions</span> and <span class="option">-lprofilingS</span> options for profiling, and it would look similar to this: 
                        </p>
                        
                        <pre class="codeblock" xml:space="preserve">CFLAGS += -g -O0 -finstrument-functions 
LDLIBS += -lprofilingS</pre>
                        
                        <p>If the <span class="filepath">Makefile</span> doesn't use the default linking and compile rules, flags and/or library, for profiling you'll need to manually include the
                           <span class="option">-finstrument-functions</span> and <span class="option">-lprofilingS</span> options as in the following example: 
                        </p>
                        
                        <pre class="codeblock" xml:space="preserve">main.o 
       qcc -g -O0 -finstrument-functions -o main.o main.c
binary: 
       qcc -o binary main.o -lprofilingS</pre>
                        
                        <p>For QNX recursive <span class="filepath">Makefiles</span>, you would also have the <span class="option">-finstrument-functions</span> and <span class="option">profilingS</span> options, and the <span class="filepath">Makefile</span> would look similar to the following: 
                        </p>
                        
                        <pre class="codeblock" xml:space="preserve">CFLAGS += -g -O0 -finstrument-functions 
LIBS += profilingS</pre>
                        
                        <p>The <var class="varname">LIBS</var> variable adds the list of libraries to include into the appropriate compiler options for profiling; you don't use <var class="varname">LDFLAGS</var> or <var class="varname">LDOPTS</var> to add libraries. 
                        </p>
                        
                        
                        <p>Notice that in the examples above, the <span class="option">-l</span> option appears at the end of each statement. This positioning occurs because <span class="cmdname">qcc</span> doesn't understand the <span class="option">-l</span> option before source and objects files; it must appear at the end. 
                        </p>
                        
                        
                     </div>
                     
                  </li>
               </ul>
               
               <div class="note"><span class="notetitle">Note:</span> 
                  
                  <p>The QNX Application Profiler uses the information in the debuggable executables to correlate lines of code in your executable
                     and the source code. To maximize the information you get while profiling, use executables with debug information for both
                     running and debugging.
                  </p>
                  
                  
               </div>
               
            </li>
         </ul>
         
         
      </div>
      
      
      <div>
         
         <div class="familylinks">
            
            <div class="parentlink"><strong>Parent topic:</strong> <a href="../topic/profiler_build_.html" shape="rect">Building a program for profiling</a></div>
            
         </div>
         
      </div>
      
      <div id="custom-footer">
         	
         <p class="copyright-notice"><a href="PLUGINS_ROOT/com.qnx.doc.copyright/topic/copyright_overview.html" style="color:black" shape="rect">Copyright</a> | <a href="http://community.qnx.com/sf/sfmain/do/home" style="color:black" shape="rect">Community</a></p>
         
      </div>
      
   </body>
</html>